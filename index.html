<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vite App</title>
</head>
<body>
  <div id="app"></div>
  <script type="module" src="/src/main.js"></script>

  <form action="">
    <input type="file" name="pic" accept="html" id="htmlFile">
    <button type="button" onclick="save">Save</button>
  </form>
  
  <p id="htos"></p>
<script>
const content = document.querySelector('#htos');
var new_content ='';

function readSingleFile(evt) {
  //Retrieve the first (and only!) File from the FileList object
  var f = evt.target.files[0]; 
  if (f) {
    var r = new FileReader();
    r.onload = function(e) { 
      var contents = e.target.result;
      alert(contents);
      new_content = contents.replace(/<title>(.*?)<\/title>/g,"<title></title>")
      content.innerText = new_content
      
    }
    r.readAsText(f);
  } else { 
    alert("Failed to load file");
  }
}

function save() {
      alert(new_content);
      var file_name = 'new.html'
      var file = new Blob([new_content], {type: 'text/html'});
        if (window.navigator.msSaveOrOpenBlob) {
            window.navigator.msSaveOrOpenBlob(file, file_name);
         } else { 
            var a = document.createElement("a"),
                    url = window.URL.createObjectURL(file);
            a.href = url;
            a.download = file_name;
            document.body.appendChild(a);
            a.click();
            setTimeout(function() {
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);  
            }, 0); 
      }
}
document.getElementById('htmlFile').addEventListener('change', readSingleFile, false);
</script>
</body>
</html>
